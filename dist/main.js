"use strict";function queen(e){var t=e.room,o=t.controller.level,r=Memory.recipes.frog,s=Memory.recipes.toad,i=Memory.recipes.newt,m=Math.min(t.memory.jobs.collect.tasks.length,t.memory.jobs.deposit.tasks.length),a=Math.max(t.memory.jobs.construct.tasks.length,t.memory.jobs.sweep.tasks.length+t.memory.sc),n=t.memory.sc;if(t.roleCount("toad")<n){var R=e.spawnCreep(s,o+1);R||(R=e.spawnCreep(s,o))}else if(t.roleCount("frog")<a){var h=e.spawnCreep(r,o+1);h||(h=e.spawnCreep(r,o))}else if(t.roleCount("newt")<m){var y=e.spawnCreep(i,o+1);y||(y=e.spawnCreep(i,o)),y||(y=e.spawnCreep(i,1))}}function tower(e){var t=e.pos.findInRange(FIND_HOSTILE_CREEPS,15);e.room.memory.towers||(e.room.memory.towers={}),e.room.memory.towers[e.id]||(e.room.memory.towers[e.id]={}),e.room.memory.towers[e.id].mode||(e.room.memory.towers[e.id].mode="alert"),e.energy<=900||t.length>0?e.room.memory.towers[e.id].mode="alert":e.energy>900&&(e.room.memory.towers[e.id].mode="repair");var o=e.room.memory.towers[e.id].mode;if("alert"==o){var r=e.room.find(FIND_MY_CREEPS,{filter:function(e){return e.hits<e.hitsMax}});t.length>0?(t.length>1&&t.sort(function(e,t){return e.hits-t.hits}),e.attack(t[0])):r.length>0&&(r.length>1&&r.sort(function(e,t){return e.hits-t.hits}),e.heal(r[0]))}else if("repair"==o){var s=e.room.memory.jobs.fix.tasks;e.repair(Game.getObjectById(s[0]))}else t.length>0&&(t.length>1&&t.sort(function(e,t){return e.hits-t.hits}),e.attack(t[0]))}StructureContainer.prototype.report=function(){this.store.energy>=50&&this.room.memory.jobs.collect.tasks.push(this.id),this.hits<1e4&&this.room.memory.jobs.fix.tasks.push(this.id)},StructureController.prototype.report=function(){this.room.energyCapacity==CONTROLLER_STRUCTURES.extension[this.room.rcl]*EXTENSION_ENERGY_CAPACITY[this.room.rcl]&&this.room.memory.jobs.upgrade.tasks.push(this.id)},Creep.prototype.report=function(e){this.room.memory.jobs[e].tasks.push(this.id)},StructureExtension.prototype.report=function(){this.energy<this.energyCapacity&&this.room.memory.jobs.deposit.tasks.push(this.id),this.hits<this.hitsMax&&this.room.memory.jobs.fix.tasks.push(this.id)},Resource.prototype.report=function(){this.room.memory.jobs.sweep.tasks.push(this.id)},StructureRoad.prototype.report=function(){this.hits<this.hitsMax&&this.room.memory.jobs.fix.tasks.push(this.id)},Room.prototype.initializeMemory=function(){this.memory.towers||(this.memory.towers={}),this.memory.sc||(this.memory.sc=this.find(FIND_SOURCES).length)},Room.prototype.queueTasks=function(){var e=this.find(FIND_STRUCTURES);if(e.length)for(var t in e)try{e[t].report()}catch(o){console.log("No report method for "+e[t]+t.structureType)}var o=this.find(FIND_DROPPED_RESOURCES);if(o.length)for(var r in o){var s=o[r];this.memory.jobs.sweep.tasks.push(s.id)}for(var i in Game.constructionSites)this.memory.jobs.construct.tasks.push(i);var m=this.find(FIND_SOURCES_ACTIVE);if(m.length)for(var a in m){var n=m[a];this.memory.jobs.mine.tasks.push(n.id)}},Room.prototype.releaseTask=function(e){return this.memory.jobs[e].tasks||(this.memory.jobs[e].tasks=[]),this.memory.jobs[e].tasks.length>0?this.memory.jobs[e].tasks.shift():null},Room.prototype.roleCount=function(e){return this.find(FIND_MY_CREEPS,{filter:function(t){return t.memory.role==e}}).length},Source.prototype.report=function(){this.energy>0&&this.room.memory.jobs.mine.tasks.push(this.id)},StructureSpawn.prototype.report=function(){this.energy<this.energyCapacity?this.room.memory.jobs.deposit.tasks.push(this.id):this.room.memory.jobs.eat.tasks.push(this.id),this.hits<this.hitsMax&&this.room.memory.jobs.fix.tasks.push(this.id)},StructureSpawn.prototype.spawnCreep=function(e,t){switch(this.createCreep(e.parts[t],e.options.role+"_"+Game.time+"_"+this.room.name,e.options)){case-3:console.log("There is already a creep with this name");break;case-10:console.log("Body part array not properly formed: "),console.log(JSON.stringify(e.parts[t]));break;case-14:console.log("RCL no longer sufficient to use this spawn")}},StructureStorage.prototype.report=function(){this.energy>=50&&this.room.memory.jobs.collect.tasks.push(this.id),this.hits<this.hitsMax&&this.room.memory.jobs.fix.tasks.push(this.id)},StructureTower.prototype.report=function(){this.energy<this.energyCapacity&&this.room.memory.jobs.deposit.tasks.push(this.id),this.hits<this.hitsMax&&this.room.memory.jobs.fix.tasks.push(this.id)},StructureWall.prototype.report=function(){this.hits<1e3&&this.room.memory.jobs.fix.tasks.push(this.id)},Creep.prototype.aid=function(){if(this.memory.jobs.aid)switch(this.heal(Game.getObjectById(this.memory.jobs.aid))){case 0:return Memory.emoji.aid;case-9:return this.moveTo(Game.getObjectById(this.memory.jobs.aid),{visualizePathStyle:{fill:"transparent",stroke:"#ffaaaa",lineStyle:"solid",strokeWidth:.15,opacity:.1}}),Memory.emoji.hop}return Memory.emoji.oops+Memory.emoji.aid+Memory.emoji.oops},Creep.prototype.collect=function(){if(this.memory.jobs.collect)switch(this.withdraw(Game.getObjectById(this.memory.jobs.collect),RESOURCE_ENERGY)){case 0:return Memory.emoji.collect;case-9:return this.moveTo(Game.getObjectById(this.memory.jobs.collect),{reusePath:1,visualizePathStyle:{fill:"transparent",stroke:"#eeff99",lineStyle:"dashed",strokeWidth:.15,opacity:.1}}),Memory.emoji.hop}return Memory.emoji.oops+Memory.emoji.collect+Memory.emoji.oops},Creep.prototype.construct=function(){if(this.memory.jobs.construct)switch(this.build(Game.getObjectById(this.memory.jobs.construct))){case 0:return Memory.emoji.construct;case-9:return this.moveTo(Game.getObjectById(this.memory.jobs.construct),{visualizePathStyle:{fill:"transparent",stroke:"#aacc66",lineStyle:"solid",strokeWidth:.15,opacity:.1}}),Memory.emoji.hop}return Memory.emoji.oops+Memory.emoji.construct+Memory.emoji.oops},Creep.prototype.requestTask=function(e){return this.memory.jobs[e]=this.room.releaseTask(e),!!this.memory.jobs[e]&&(this.room.memory.jobs[e].tasks.push(this.memory.jobs[e]),!0)},Creep.prototype.aidAura=function(){for(var e in this.room.memory.jobs.aid.tasks){if(0===this.heal(Game.getObjectById(this.room.memory.jobs.aid.tasks[e]),RESOURCE_ENERGY))return!0;if(0===this.rangedHeal(Game.getObjectById(this.room.memory.jobs.aid.tasks[e]),RESOURCE_ENERGY))return!0}return!1},Creep.prototype.collectAura=function(){for(var e in this.room.memory.jobs.collect.tasks)if(0===this.withdraw(Game.getObjectById(this.room.memory.jobs.collect.tasks[e]),RESOURCE_ENERGY))return!0;return!1},Creep.prototype.constructAura=function(){for(var e in this.room.memory.jobs.construct.tasks)if(0===this.build(Game.getObjectById(this.room.memory.jobs.construct.tasks[e]),RESOURCE_ENERGY))return!0;return!1},Creep.prototype.depositAura=function(){for(var e in this.room.memory.jobs.deposit.tasks)if(Game.getObjectById(this.room.memory.jobs.deposit.tasks[e])&&0===this.transfer(Game.getObjectById(this.room.memory.jobs.deposit.tasks[e]),RESOURCE_ENERGY))return!0;return!1},Creep.prototype.eatAura=function(){for(var e in this.room.memory.jobs.eat.tasks)if(0===Game.getObjectById(this.room.memory.jobs.eat.tasks[e]).renewCreep(this))return!0;return!1},Creep.prototype.fixAura=function(){for(var e in this.room.memory.jobs.fix.tasks)if(0===this.repair(Game.getObjectById(this.room.memory.jobs.fix.tasks[e])))return!0;return!1},Creep.prototype.mineAura=function(){for(var e in this.room.memory.jobs.mine.tasks)if(0===this.harvest(Game.getObjectById(this.room.memory.jobs.mine.tasks[e])))return!0;return!1},Creep.prototype.sweepAura=function(){for(var e in this.room.memory.jobs.sweep.tasks)if(0===this.pickup(Game.getObjectById(this.room.memory.jobs.sweep.tasks[e]),RESOURCE_ENERGY))return!0;return!1},Creep.prototype.upgradeAura=function(){for(var e in this.room.memory.jobs.upgrade.tasks)if(Game.getObjectById(this.room.memory.jobs.upgrade.tasks[e])&&0===this.upgradeController(Game.getObjectById(this.room.memory.jobs.upgrade.tasks[e]),RESOURCE_ENERGY))return!0;return!1},Creep.prototype.whackAura=function(){for(var e in this.room.memory.jobs.whack.tasks)if(Game.getObjectById(this.room.memory.jobs.whack.tasks[e])){if(0===this.attack(Game.getObjectById(this.room.memory.jobs.whack.tasks[e])))return!0;if(0===this.rangedAttack(Game.getObjectById(this.room.memory.jobs.whack.tasks[e])))return!0}return!1},Creep.prototype.deposit=function(){if(this.memory.jobs.deposit)switch(this.transfer(Game.getObjectById(this.memory.jobs.deposit),RESOURCE_ENERGY)){case 0:return Memory.emoji.deposit;case-9:return this.moveTo(Game.getObjectById(this.memory.jobs.deposit),{reusePath:10,visualizePathStyle:{fill:"transparent",stroke:"#eecc00",lineStyle:"dashed",strokeWidth:.15,opacity:.1}}),Memory.emoji.frog}return Memory.emoji.oops+Memory.emoji.deposit+Memory.emoji.oops},Creep.prototype.eat=function(){if(this.memory.jobs.eat)switch(Game.getObjectById(this.memory.jobs.eat).renewCreep(this)){case 0:return Memory.emoji.eat;case-9:return this.moveTo(Game.getObjectById(this.memory.jobs.eat),{visualizePathStyle:{fill:"transparent",stroke:"#00eeff",lineStyle:"solid",strokeWidth:.15,opacity:.1}}),Memory.emoji.hop}return Memory.emoji.oops+Memory.emoji.eat+Memory.emoji.oops},Creep.prototype.fix=function(){if(this.memory.jobs.fix)switch(this.repair(Game.getObjectById(this.memory.jobs.fix))){case 0:return Memory.emoji.fix;case-9:return this.moveTo(Game.getObjectById(this.memory.jobs.fix),{visualizePathStyle:{fill:"transparent",stroke:"#ffaaaa",lineStyle:"solid",strokeWidth:.15,opacity:.1}}),Memory.emoji.fix}return Memory.emoji.oops+Memory.emoji.fix+Memory.emoji.oops},Creep.prototype.mine=function(){if(this.memory.jobs.mine)switch(this.harvest(Game.getObjectById(this.memory.jobs.mine))){case 0:return Memory.emoji.mine;case-9:return this.moveTo(Game.getObjectById(this.memory.jobs.mine),{visualizePathStyle:{reusePath:10,fill:"transparent",stroke:"#eeff99",lineStyle:"solid",strokeWidth:.15,opacity:.1}}),Memory.emoji.hop}return Memory.emoji.oops+Memory.emoji.mine+Memory.emoji.oops},Creep.prototype.sweep=function(){if(this.memory.jobs.sweep)switch(this.pickup(Game.getObjectById(this.memory.jobs.sweep))){case 0:return Memory.emoji.sweep;case-9:return this.moveTo(Game.getObjectById(this.memory.jobs.sweep),{visualizePathStyle:{fill:"transparent",stroke:"#eecc00",lineStyle:"dashed",strokeWidth:.15,opacity:.1}}),Memory.emoji.frog}return Memory.emoji.oops+Memory.emoji.sweep+Memory.emoji.oops},Creep.prototype.upgrade=function(){if(this.memory.jobs.upgrade)switch(this.upgradeController(Game.getObjectById(this.memory.jobs.upgrade))){case 0:return Memory.emoji.upgrade;case-9:return this.moveTo(Game.getObjectById(this.memory.jobs.upgrade),{visualizePathStyle:{fill:"transparent",stroke:"#ffffff",lineStyle:"solid",strokeWidth:.15,opacity:.1}}),Memory.emoji.frog}return Memory.emoji.oops+Memory.emoji.upgrade+Memory.emoji.oops},Creep.prototype.whack=function(){if(this.memory.jobs.whack)switch(this.attack(Game.getObjectById(this.memory.jobs.whack))){case 0:return Game.getObjectById(this.memory.jobs.whack).deleteTask("whack"),Memory.emoji.whack;case-9:return this.moveTo(Game.getObjectById(this.memory.jobs.whack),{visualizePathStyle:{fill:"transparent",stroke:"#ff0000",lineStyle:"solid",strokeWidth:.15,opacity:.1}}),Memory.emoji.whack}return Memory.emoji.oops+Memory.emoji.whack+Memory.emoji.oops},Creep.prototype.frog=function(e,t){return 0===this.carry.energy&&(this.memory.state=0),this.carry.energy<this.carryCapacity&&this.report("deposit"),this.carry.energy===this.carryCapacity&&(this.memory.state=1),this.memory.state?this.requestTask("construct")?this.construct():this.requestTask("upgrade")?this.upgrade():this.requestTask("eat")?this.eat():"zzz":this.requestTask("collect")?this.collect():this.requestTask("sweep")?this.sweep():this.requestTask("mine")?this.mine():"zzz"},Creep.prototype.newt=function(){if(0==this.carry.energy?this.memory.state=0:this.carry.energy===this.carryCapacity&&(this.memory.state=1),this.memory.state){if(this.requestTask("deposit"))return this.deposit();if(this.requestTask("eat"))return this.eat()}else{if(this.requestTask("collect"))return this.collect();if(this.requestTask("sweep"))return this.sweep()}},Creep.prototype.toad=function(){0===this.carry.energy&&(this.memory.state=0),this.carry.energy===this.carryCapacity&&(this.memory.state=1);var e="";if(this.requestTask("mine")){0===this.upgrade()?(this.mine(),e+=Memory.emoji.sogood):e+=this.mine()}else this.requestTask("eat")?e+=this.eat():this.requestTask("construct")?e+=this.construct():e+=Memory.emoji.sogood;return e},Memory.recipes||(Memory.recipes={},Memory.recipes.frog={parts:{1:[MOVE,CARRY,MOVE,WORK],2:[MOVE,CARRY,MOVE,WORK],3:[MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK],4:[MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK],5:[MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK],6:[MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK],7:[MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK],8:[MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK,MOVE,CARRY,MOVE,WORK]},options:{role:"frog",resourceType:RESOURCE_ENERGY,jobs:{construct:null,collect:null,fix:null,sweep:null,mine:null,eat:null,upgrade:null}}},Memory.recipes.newt={parts:{1:[MOVE,CARRY,MOVE,CARRY],2:[MOVE,CARRY,MOVE,CARRY],3:[MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY],4:[MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY],5:[MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY],6:[MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY],7:[MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY],8:[MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,MOVE,CARRY,CARRY,CARRY,CARRY,CARRY,CARRY,CARRY,CARRY,CARRY]},options:{role:"newt",resourceType:RESOURCE_ENERGY,jobs:{deposit:null,collect:null,sweep:null,eat:null}}},Memory.recipes.toad={parts:{1:[MOVE,WORK,CARRY,WORK],2:[MOVE,WORK,CARRY,WORK],3:[MOVE,WORK,WORK,MOVE,WORK,WORK,CARRY],4:[MOVE,WORK,WORK,MOVE,WORK,WORK,MOVE,WORK,WORK,CARRY],5:[MOVE,WORK,WORK,MOVE,WORK,WORK,MOVE,WORK,WORK,MOVE,WORK,WORK,CARRY],6:[MOVE,WORK,WORK,MOVE,WORK,WORK,MOVE,WORK,WORK,MOVE,WORK,WORK,CARRY],7:[MOVE,WORK,WORK,MOVE,WORK,WORK,MOVE,WORK,WORK,MOVE,WORK,WORK,MOVE,WORK,WORK,MOVE,CARRY],8:[MOVE,WORK,WORK,MOVE,WORK,WORK,MOVE,WORK,WORK,MOVE,WORK,WORK,MOVE,WORK,WORK,MOVE,CARRY]},options:{role:"toad",resourceType:RESOURCE_ENERGY,builtcontainer:0,jobs:{construct:null,fix:null,sweep:null,mine:null,eat:null,upgrade:null}}}),Memory.emoji={frog:"🐸",construct:"🛠️️",fix:"🏗️🏚️",mine:"💰",upgrade:"⚡",eat:"🍽️",deposit:"✨",collect:"✨",oops:"☠️",whack:"⚔️",pew:"🔫",aid:"💊",pickup:"✨",suicide:"💮",sogood:"✨🐸✨",hop:"💨"},module.exports.loop=function(){for(var e in Memory.rooms){var t=Game.rooms[e];t.initializeMemory(),t.memory.jobs={whack:{workers:[],tasks:[]},construct:{workers:[],tasks:[]},deposit:{workers:[],tasks:[]},collect:{workers:[],tasks:[]},aid:{workers:[],tasks:[]},fix:{workers:[],tasks:[]},sweep:{workers:[],tasks:[]},mine:{workers:[],tasks:[]},eat:{workers:[],tasks:[]},upgrade:{workers:[],tasks:[]}},t.queueTasks()}for(var o in Game.structures){var r=Game.structures[o];switch(r.structureType){case"tower":tower(r);break;case"spawn":Memory.spawns[r.name].queen&&queen(r)}}for(var s in Memory.creeps){var i=Game.creeps[s];switch(i.sweepAura(),i.eatAura(),i.collectAura(),i.memory.role){case"frog":i.mineAura(),i.constructAura(),i.upgradeAura();break;case"toad":i.upgradeAura(),i.depositAura();break;case"newt":i.depositAura()}}for(var m in Memory.creeps)if(Game.creeps[m]){if(Game.creeps[m]){var i=Game.creeps[m];switch(i.memory.room||(i.memory.room=i.room.name),i.memory.role){case"frog":i.say(i.frog());break;case"toad":i.say(i.toad());break;case"newt":i.say(i.newt())}}}else delete Memory.creeps[m]};